<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hello World</title>
  <meta name="author" content="Mallven">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mallven.com/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="" rel="alternate" title="Hello World" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  

</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Hello World</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
		<li >
                    <a href="/projects">Projects</a>
                </li>
		<li >
                    <a href="/reading">Reading</a>
                </li>	
		<li >
                    <a href="/about">About</a>
                </li>	
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index">
      
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-04-15T11:40:31+08:00" pubdate data-updated="true">Apr 15<span>th</span>, 2015</time>
        
        
          | <a href="/blog/2015/04/15/how-synchronized-lock-works/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2015/04/15/how-synchronized-lock-works/">How Synchronized-lock in Java Works</a></h1>
    
  </header>


  <div class="entry-content clearfix">
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-04-10T11:38:18+08:00" pubdate data-updated="true">Apr 10<span>th</span>, 2015</time>
        
        
          | <a href="/blog/2015/04/10/how-locks-in-java-works/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2015/04/10/how-locks-in-java-works/">How Locks in Java Works</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h4>1. Lock Types in Java</h4>

<p>There are four lock types in java(From JDK1.6):</p>

<blockquote><p>None-Lock<br/>
Biased-Lock<br/>
LightWeight-Lock<br/>
HeavyWeight-Lock</p></blockquote>

<h4>2. where is the lock type stored in</h4>

<p>Lock type is stored in the <code>MARK WORD</code> in the head data of an object:<br/>
Table 1 is a table of the details of a 32-bit JVM&rsquo;s  <code>MARK WORD</code> with no lock,it contains <code>HashCode</code>,<code>Object Generation</code>,<code>Lock Type</code> , The data holded by <code>Mark Word</code> will change while lock type changes during Runtime.</p>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2015/04/10/how-locks-in-java-works/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-04-01T11:32:34+08:00" pubdate data-updated="true">Apr 1<span>st</span>, 2015</time>
        
        
          | <a href="/blog/2015/04/01/how-garbage-collection-works/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2015/04/01/how-garbage-collection-works/">How Garbage Collection Work</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h3>1.Disadvantage of Explicit Memory Management</h3>

<p>Before the advent of Automatic Memory Mangement, programmers are  responsible for the memeory management, they allocate and deallocate memeory by their codes.
But sometimes manage memory by hand will cause many memeory related problems when  programs become relative complexed. eg:</p>

<h4>1.1. Dangling References</h4>

<p>When we deallocate the space used by an object to which some other objects still has a reference. If the object with that reference tries to access the original object, but the space has been reallocated to a new object, the result would be unpredictable.</p>

<h4>1.2. Space Leaks</h4>

<p>If one object has a reference of another object, we deallocate the space used by the first object but forgot to free the space used by the second object. The second object could not be referenced by other objects or be deallocated, it will become a no-reachable object, if there are many objects like this in our program, the physical memory will be exhausted soon.</p>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2015/04/01/how-garbage-collection-works/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-03-24T14:12:42+08:00" pubdate data-updated="true">Mar 24<span>th</span>, 2015</time>
        
        
          | <a href="/blog/2015/03/24/jvm-memory-structure-and-object-allocation/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2015/03/24/jvm-memory-structure-and-object-allocation/">Java&#8217;s Memory Model and Object Allocation</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h3>1. Java&rsquo;s memory model</h3>

<p>From Java 2 Standard Edition, Java performs automatic memory management. In order to enhance the garbage collection&rsquo;s efficiency, Java bring in generational memory model. <br/>
Figure 1 is a picture I find from &ldquo;pointsoftware.com&rdquo;</p>

<p><img src="/images/blog/2015-03/20150324-RuntimeDataAreas_JVM_Model.png" alt="java memeory model" /></p>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2015/03/24/jvm-memory-structure-and-object-allocation/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-03-16T13:57:42+08:00" pubdate data-updated="true">Mar 16<span>th</span>, 2015</time>
        
        
          | <a href="/blog/2015/03/16/how-hashmap-works/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2015/03/16/how-hashmap-works/">How HashMap Works</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h3>1.The Structure of HashMap</h3>

<p>As we know,all structures of object in Java are based on array and reference,HashMap is same too. A HashMap structure consist of two parts:Array and LinkList(Figure 1).</p>

<p><img src="/images/blog/2015-03/20150316-hashmap-structure.png" alt="HashMap Structure" /></p>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2015/03/16/how-hashmap-works/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-06-21T18:02:59+08:00" pubdate data-updated="true">Jun 21<span>st</span>, 2014</time>
        
        
          | <a href="/blog/2014/06/21/netbeans-debug-hotspot/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/06/21/netbeans-debug-hotspot/">Netbeans Debug Hotspot</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>学习JVM的过程中肯定不能少了对JVM的调试，进行就学习一下怎样用Netbeans调试Hotspot。</p>

<h4>编译过程</h4>

<p>环境：</p>

<blockquote><p>Ubuntu12.04<br/>
OpenJdk 7u<br/>
Netbeans7.0.1(c/c++)</p></blockquote>

<p>1.安装编译所需要的工具。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">ant</span> <span class="n">mercurial</span> <span class="n">gawk</span> <span class="n">g</span><span class="o">++</span> <span class="n">libcups2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libasound2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libfreetype6</span><span class="o">-</span><span class="n">dev</span> <span class="n">libx11</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxt</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxext</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxrender</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxtst</span><span class="o">-</span><span class="n">dev</span> <span class="n">libfontconfig1</span><span class="o">-</span><span class="n">dev</span>
</span></code></pre></td></tr></table></div></figure>


</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2014/06/21/netbeans-debug-hotspot/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-06-15T10:01:00+08:00" pubdate data-updated="true">Jun 15<span>th</span>, 2014</time>
        
        
          | <a href="/blog/2014/06/15/java-object-create-2/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/06/15/java-object-create-2/">JVM 之 Java对象创建[初始化]</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>上一篇文章简单介绍了类的加载和连接阶段，今天来简单看一下类的初始化过程。<br/>
还是使用上文的例子:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">Class</span> <span class="n">claszz</span> <span class="o">=</span> <span class="n">clt</span><span class="o">.</span><span class="na">loadClass</span><span class="o">(</span><span class="s">&quot;Animal&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">Animal</span> <span class="n">animal</span> <span class="o">=</span> <span class="o">(</span><span class="n">Animal</span><span class="o">)</span><span class="n">claszz</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>newInstance</code>的native方法在:src/share/native/sun/reflect/NativeAccessors.c</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">JNIEXPORT</span> <span class="n">jobject</span> <span class="n">JNICALL</span> <span class="nf">Java_sun_reflect_NativeConstructorAccessorImpl_newInstance0</span>
</span><span class='line'><span class="o">(</span><span class="n">JNIEnv</span> <span class="o">*</span><span class="n">env</span><span class="o">,</span> <span class="n">jclass</span> <span class="n">unused</span><span class="o">,</span> <span class="n">jobject</span> <span class="n">c</span><span class="o">,</span> <span class="n">jobjectArray</span> <span class="n">args</span><span class="o">)</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'><span class="k">return</span> <span class="nf">JVM_NewInstanceFromConstructor</span><span class="o">(</span><span class="n">env</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2014/06/15/java-object-create-2/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-06-14T08:53:49+08:00" pubdate data-updated="true">Jun 14<span>th</span>, 2014</time>
        
        
          | <a href="/blog/2014/06/14/java-object-create-1/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/06/14/java-object-create-1/">JVM 之 Java对象创建[加载和连接]</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>Java对象的生命周期可以分为：加载，验证，准备，解析，初始化，使用，卸载 八个阶段。其中验证，准备，解析又被统称为连接，今天主要是简单看一下加载和连接，下一篇文章讲初始化。<br/>
<img src="/images/blog/2014-06/20140614-java-load-pic.png" alt="对象生命周期" /><br/>
说明：</p>

<blockquote><p>本文章所涉及的代码Gist地址:<a href="https://gist.github.com/zarue/0d5f83fa8458a9298b9d">点击查看</a><br/>
本文使用是Jdk6u-Hotspot</p></blockquote>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2014/06/14/java-object-create-1/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-05-29T20:58:21+08:00" pubdate data-updated="true">May 29<span>th</span>, 2014</time>
        
        
          | <a href="/blog/2014/05/29/runtime-string-pool-2/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/05/29/runtime-string-pool-2/">JVM 之 String 常量池 二</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>上一篇文章<a href="/blog/2014/05/27/runtime-string-pool-1">JVM 之 String 常量池 一</a>中我们了解到JVM中有一个叫String常量池的东西，String常量池到底是什么样？，又是怎样工作的呢？今天就来看一下。<br/>
做任何事情都要首先找一个入口。我们怎么才能找到常量池的入口呢？<br/>
我们首先想到String里面有个intern方法，可以在运行时向常量池中动态添加字符串。我们就从这个方法入手。<br/>
先看String 的intern的源代码:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">native</span> <span class="n">String</span> <span class="nf">intern</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>这是一个native 方法，也就是这个方法不是用java实现的，要找到这个native 方法就要去<a href="http://openjdk.java.net/">JDK的源代码</a>中查找，它位于<code>openjdk/jdk/src/share/native/java/lang</code>目录中的<code>String.c</code>中。这个目录下还有许多其他java类中对应的native方法的实现，例如object类中的<code>hashCode</code>,<code>getClass</code>,<code>clone</code>等方法都在<code>Object.c</code>里面。 <br/>
String.c 中只有一个方法：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="err">#</span><span class="n">include</span> <span class="s">&quot;jvm.h&quot;</span>
</span><span class='line'><span class="err">#</span><span class="n">include</span> <span class="s">&quot;java_lang_String.h&quot;</span>
</span><span class='line'><span class="n">JNIEXPORT</span> <span class="n">jobject</span> <span class="n">JNICALL</span>
</span><span class='line'><span class="nf">Java_java_lang_String_intern</span><span class="o">(</span><span class="n">JNIEnv</span> <span class="o">*</span><span class="n">env</span><span class="o">,</span> <span class="n">jobject</span> <span class="k">this</span><span class="o">)</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'><span class="k">return</span> <span class="nf">JVM_InternString</span><span class="o">(</span><span class="n">env</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2014/05/29/runtime-string-pool-2/">MORE</a>
    </footer>
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-05-27T20:30:20+08:00" pubdate data-updated="true">May 27<span>th</span>, 2014</time>
        
        
          | <a href="/blog/2014/05/27/runtime-string-pool-1/#comments">Comments</a>
         
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/05/27/runtime-string-pool-1/">JVM 之 String 常量池 一</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h4>1.Sting对象创建方式</h4>

<p>JAVA里面创建字符串有两种方式：<br/>
1. 通过字符串常量方式:String a = &ldquo;a&rdquo;;<br/>
2. 通过new 关键字创建:new String(&ldquo;a&rdquo;);</p>

<p>但是这两种创建字符串的方式有很大的不同。<br/>
1. 使用第一种方式，jvm首先会检查字符串常量池中是否存在了这个常量，如果存在，就返回池中的实例引用。如果不存在，就会实例化一个字符串并放到池中,然后返回引用。<br/>
2. 使用第二种方式，则直接分配到heap中，不指向字符串常量池中的任何对象，和字符串常量池没有关系。</p>

<h4>2.下面来看一个例子: <a href="https://gist.github.com/zarue/25e0afedb33de86da650">本例子Gist地址</a></h4>

</div>
  
  
    <footer>
      <a class="btn btn-default" rel="full-article" href="/blog/2014/05/27/runtime-string-pool-1/">MORE</a>
    </footer>
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/blog/page/2/">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next disabled"><a href="#">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Mallven</h3>
  </div>
  <div id="about_me" class="list-group">
  <div style="padding-top:15px;padding-bottom:15px;text-align:center">
	<span >Good Good Study, Day Day Up</span>	  </div>
  <div class="social" style="text-align:center">
		 
                <a class="github" target="_blank"  href="https://github.com/zarue" title="GitHub">GitHub</a>
                		
		
		<a class="weibo" target="_blank"  href="http://www.weibo.com/2403887405" title="Weibo">Weibo</a>
		
		
		<a class="facebook" target="_blank"  href="http://www.facebook.com/yonghua.ma" title="Facebook">Facebook</a>
		
		
		
		<a class="twitter" target="_blank"  href="http://twitter.com/cheney_life" title="Twitter">Twitter</a>
		
		
		
		
		
		
		
	</div>  
</div>
</section>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2015/04/15/how-synchronized-lock-works/">How Synchronized-lock in Java Works</a>
    
    <a class="list-group-item " href="/blog/2015/04/10/how-locks-in-java-works/">How Locks in Java Works</a>
    
    <a class="list-group-item " href="/blog/2015/04/01/how-garbage-collection-works/">How Garbage Collection Work</a>
    
    <a class="list-group-item " href="/blog/2015/03/24/jvm-memory-structure-and-object-allocation/">Java&#8217;s Memory Model and Object Allocation</a>
    
    <a class="list-group-item " href="/blog/2015/03/16/how-hashmap-works/">How HashMap Works</a>
    
  </div>
</section>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div id="categories" class="list-group">
  <a class='list-group-item'  href='/blog/categories/java/'>java (1)</a>
<a class='list-group-item'  href='/blog/categories/jvm/'>jvm (9)</a>
<a class='list-group-item'  href='/blog/categories/story/'>story (1)</a>
<a class='list-group-item'  href='/blog/categories/system/'>system (1)</a>
<a class='list-group-item'  href='/blog/categories/vim/'>vim (1)</a>
 
 </div>
</section>





      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2015 - Mallven<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>












  </body>
</html>
