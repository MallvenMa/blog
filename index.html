
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>zarue</title>
	<meta name="author" content="YungHua.Ma">

	
	<meta name="description" content="welcome to my blog">
	<meta name="keywords" content="jvm,program,zarue,yunghua.ma,coder">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="" rel="alternate" title="zarue" type="application/atom+xml">
	
	<link rel="canonical" href="http://blog.zarue.com//">
	<link href="/favicon.ico" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		document.write("<img src='/images/myself.jpg' alt='Profile Picture' style='width: 160px;'/>");
	</script>
</div>
<h2><a href="/">YungHua.Ma</a></h2>
<h5 class="subtitle">天若有情天亦老 人丑就要多读书</h5>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		 
                <a class="github" href="https://github.com/zarue" title="GitHub">GitHub</a>
                		
		
		<a class="weibo" href="http://www.weibo.com/2403887405" title="Weibo">Weibo</a>
		
		
		<a class="facebook" href="http://www.facebook.com/yonghua.ma" title="Facebook">Facebook</a>
		
		
		
		<a class="twitter" href="http://twitter.com/cheney_life" title="Twitter">Twitter</a>
		
		
		
		
		
		
		
	</div>
</nav>
<!-- <hgroup>
  <h3>YungHua.Ma</h3>
  
    <h5>I hava a dream to walk around the world</h5>
  
</hgroup>
-->
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-06-14T08:53:49+08:00" data-updated="true" itemprop="datePublished">Jun 14<span>th</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/jvm/'>jvm</a>


</div>
		
			<span class="comments"><a href="/blog/2014/06/14/java-object-create-1/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/06/14/java-object-create-1/" itemprop="url">Java对象创建之加载和连接</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>Java对象的生命周期可以分为：<code>加载</code>，<code>验证</code>，<code>准备</code>，<code>解析</code>，<code>初始化</code>，<code>使用</code>，<code>卸载</code> 八个阶段。其中<code>验证</code>，<code>准备</code>，<code>解析</code>又被统称为<code>连接</code>，今天主要看一下<code>加载</code>和<code>连接</code>，下一篇文章讲<code>初始化</code>。<br/>
<img src="/images/blog/2014-06/20140614-java-load-pic.png" alt="对象生命周期" /><br/>
说明：本文章所涉及的代码Gist地址:<a href="https://gist.github.com/zarue/0d5f83fa8458a9298b9d">点击查看</a></p>


		
		<a href="/blog/2014/06/14/java-object-create-1/" class="more-link">阅读全文</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-29T20:58:21+08:00" data-updated="true" itemprop="datePublished">May 29<span>th</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/jvm/'>jvm</a>


</div>
		
			<span class="comments"><a href="/blog/2014/05/29/runtime-string-pool-2/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/29/runtime-string-pool-2/" itemprop="url">JVM 之 String 常量池 二</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>上一篇文章<a href="/blog/2014/05/27/runtime-string-pool-1">JVM 之 String 常量池 一</a>中我们了解到JVM中有一个叫String常量池的东西，String常量池到底是什么样？，又是怎样工作的呢？今天就来看一下。<br/>
做任何事情都要首先找一个入口。我们怎么才能找到常量池的入口呢？<br/>
我们首先想到String里面有个intern方法，可以在运行时向常量池中动态添加字符串。我们就从这个方法入手。<br/>
先看String 的intern的源代码:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">native</span> <span class="n">String</span> <span class="nf">intern</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>这是一个native 方法，也就是这个方法不是用java实现的，要找到这个native 方法就要去<a href="http://openjdk.java.net/">JDK的源代码</a>中查找，它位于<code>openjdk/jdk/src/share/native/java/lang</code>目录中的<code>String.c</code>中。这个目录下还有许多其他java类中对应的native方法的实现，例如object类中的<code>hashCode</code>,<code>getClass</code>,<code>clone</code>等方法都在<code>Object.c</code>里面。 <br/>
String.c 中只有一个方法：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="err">#</span><span class="n">include</span> <span class="s">&quot;jvm.h&quot;</span>
</span><span class='line'><span class="err">#</span><span class="n">include</span> <span class="s">&quot;java_lang_String.h&quot;</span>
</span><span class='line'><span class="n">JNIEXPORT</span> <span class="n">jobject</span> <span class="n">JNICALL</span>
</span><span class='line'><span class="nf">Java_java_lang_String_intern</span><span class="o">(</span><span class="n">JNIEnv</span> <span class="o">*</span><span class="n">env</span><span class="o">,</span> <span class="n">jobject</span> <span class="k">this</span><span class="o">)</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'><span class="k">return</span> <span class="nf">JVM_InternString</span><span class="o">(</span><span class="n">env</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/2014/05/29/runtime-string-pool-2/" class="more-link">阅读全文</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-27T20:30:20+08:00" data-updated="true" itemprop="datePublished">May 27<span>th</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/jvm/'>jvm</a>


</div>
		
			<span class="comments"><a href="/blog/2014/05/27/runtime-string-pool-1/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/27/runtime-string-pool-1/" itemprop="url">JVM 之 String 常量池 一</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h4>1.Sting对象创建方式</h4>

<p>JAVA里面创建字符串有两种方式：<br/>
1. 通过字符串常量方式:String a = &ldquo;a&rdquo;;<br/>
2. 通过new 关键字创建:new String(&ldquo;a&rdquo;);</p>

<p>但是这两种创建字符串的方式有很大的不同。<br/>
1. 使用第一种方式，jvm首先会检查字符串常量池中是否存在了这个常量，如果存在，就返回池中的实例引用。如果不存在，就会实例化一个字符串并放到池中,然后返回引用。<br/>
2. 使用第二种方式，则直接分配到heap中，不指向字符串常量池中的任何对象，和字符串常量池没有关系。</p>

<h4>2.下面来看一个例子: <a href="https://gist.github.com/zarue/25e0afedb33de86da650">本例子Gist地址</a></h4>


		
		<a href="/blog/2014/05/27/runtime-string-pool-1/" class="more-link">阅读全文</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-22T14:09:15+08:00" data-updated="true" itemprop="datePublished">May 22<span>nd</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/jvm/'>jvm</a>


</div>
		
			<span class="comments"><a href="/blog/2014/05/22/jvm-object-structure/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/22/jvm-object-structure/" itemprop="url">JVM 之 Java 对象结构</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h2>1. Java对象在内存中到底是什么样?</h2>

<p>JAVA对象在内存中的表现形式就是一系列按照<em>某种规范</em>排列的字节(如果不清楚物理内存j的实现方式，请参考：<a href="http://blog.zarue.com/blog/2014/05/21/cpu-and-memory/">关于CPU寻址和物理内存结构</a> )。
那在JVM中这个规范是怎么定义的呢？
Hotspot虚拟机中，对象分为两大类：普通对象和数组对象，两类对象在内存中的布局可以分为三部分:<code>对象头，对象实例数据， 对齐填充</code> 。不同的是普通对象的对象头是由<code>MARK WORD，CLASS对象指针</code>两部分组成，而数组对象头是由<code>MARK WORD，CLASS对象指针，数组长度</code>三部分组成，如图:<br/>
<img src="/images/blog/2014-05/20140524-object-arrayObject-structure.png" alt="对象结构" /></p>


		
		<a href="/blog/2014/05/22/jvm-object-structure/" class="more-link">阅读全文</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-21T20:35:18+08:00" data-updated="true" itemprop="datePublished">May 21<span>st</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/system/'>system</a>


</div>
		
			<span class="comments"><a href="/blog/2014/05/21/cpu-and-memory/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/21/cpu-and-memory/" itemprop="url">关于CPU寻址和物理内存结构</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h2>本文讨论的都是概念模型，实际实现方式肯定会有不同</h2>

<h3>1. 关于CPU的几个概念</h3>

<ol>
<li>数据总线：数据总线是CPU和其它组件（比如：内存）之间进行数据交互的通道。</li>
<li>数据总线宽度：是指CPU中寄存器的位数，即CPU位数，我们常说的32位，64位就是指的这个参数。CPU的位数和CPU的寻址能力没有关系。我们之前经常听到32位的CPU最大寻址能力是2<sup>32</sup> 因此它最大可识别的内存是4G，64位CPU可以识别4G以上内存，其实这是不正确的，因为CPU的寻址能力和CPU的位数没有关系。</li>
<li>地址总线：CPU是通过地址总线来进行内存寻址。</li>
<li>地址总线宽度：地址总线宽度决定了CPU的寻址范围，如果地址总线是32位，那么该CPU的寻址范围就是0-2<sup>32</sup>-1（0x00000000-0xFFFFFFFF），也就是4G个存储单元，如果存储单元是按字节编址，那么CPU可以寻址的最大内存量就是4G(byte)，这时候即使有再大的内存也不会被识别。</li>
<li>控制总线：主要是将CPU的控制指令传送到其它组件</li>
</ol>


<p>关于总线更详细的文章网上有很多，例如：</p>

<ul>
<li><a href="http://share.onlinesjtu.com/mod/tab/view.php?id=253">总线的内部结构</a></li>
<li><a href="http://my.oschina.net/u/158589/blog/70813">CPU位数，寻址能力，指令集，寄存器位数，操作系统位数</a></li>
</ul>



		
		<a href="/blog/2014/05/21/cpu-and-memory/" class="more-link">阅读全文</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-18T22:05:24+08:00" data-updated="true" itemprop="datePublished">May 18<span>th</span>, 2014</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/vim/'>vim</a>


</div>
		
			<span class="comments"><a href="/blog/2014/05/18/vim-chinese-error/#duoshuo_comments">Comments</a></span>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2014/05/18/vim-chinese-error/" itemprop="url">Mac OSX Vim 输入中文乱码问题</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h3>出现问题的环境:</h3>

<ol>
<li>OSX 10.9.2 英文</li>
<li>VIM 7.3</li>
</ol>


<h3>问题描述:</h3>

<ol>
<li>可以正常显示文件中得中文字符</li>
<li>输入中文字符会出现乱码</li>
<li>通过在.vimrc中设置编码格式无效</li>
</ol>


<h3>解决方案:</h3>

<p>找到 <code>Terminal--&gt;Preferences--&gt;Settings--&gt;Advanced--&gt;Escape non-ASCII input with Control-V</code> 取消该选项即可。</p>


		
		<a href="/blog/2014/05/18/vim-chinese-error/" class="more-link">阅读全文</a>
	</div>

</article>

</div>
<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - YungHua.Ma -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->







		</div>
	</div>
</body>
</html>
